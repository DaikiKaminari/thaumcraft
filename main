--- CONFIG ---
local centerPedestalNumber = "12"

--- GLOBAL VARIABLES ---
local centerPedestal    -- table : peripheral - the center pedestal
local pedestals = {}    -- table : peripherals - all pedestals

--- INIT ---
local function periphInit()
    centerPedestal = peripherals.find("container_pedestal_" .. centerPedestalNumber)
    if centerPedestal == nil then
        error("Center pedestal missing or wrong number : " .. centerPedestalNumber)
    end
    for _,v in pairs(pedestals.getNames()) do
        if string.find(v, "container_pedestal") then
            pedestals[v] = peripherals.find(v)
        end
    end
    if #pedestals < 12 then
        error("Missing pedestals, only [" .. tostring(#pedestals) .. "] were found.")
    end
end

-- Load apis and execute init() method if it exists
local function init(apis)
    for _,path in pairs(apis) do
        if not fs.exists(path) then
            error("API [" .. path .. "] does not exist.")
        end
        os.loadAPI(path)
    end
    for _,path in pairs(apis) do
        local api = string.gmatch(path, "([^/]+)")
        if _G[api].init ~= nil then
            api.init()
        end
    end
end

--- UTILS ---

--- FUNCTIONS ---
-- manage the altar for autocrafting
local function altarManager()

end

-- process an item in the altar
local function processItem()

end

-- main call
local function main()
    init({"lib/objectJSON"})
    periphInit()
end

main()